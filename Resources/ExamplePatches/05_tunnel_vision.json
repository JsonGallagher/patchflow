{
  "nodes": [
    {
      "id": "node_1",
      "typeId": "AudioInput",
      "x": 100,
      "y": 300,
      "params": {}
    },
    {
      "id": "node_2",
      "typeId": "EnvelopeFollower",
      "x": 320,
      "y": 200,
      "params": {
        "attackMs": 8.0,
        "releaseMs": 120.0
      }
    },
    {
      "id": "node_3",
      "typeId": "MapRange",
      "x": 520,
      "y": 200,
      "params": {
        "inMin": 0.0,
        "inMax": 0.5,
        "outMin": 0.0,
        "outMax": 1.0
      }
    },
    {
      "id": "node_4",
      "typeId": "FFTAnalyzer",
      "x": 320,
      "y": 400,
      "params": {
        "fftOrder": 11,
        "windowType": 0
      }
    },
    {
      "id": "node_5",
      "typeId": "BandSplitter",
      "x": 520,
      "y": 400,
      "params": {
        "crossover1": 60.0,
        "crossover2": 250.0,
        "crossover3": 2000.0,
        "crossover4": 6000.0
      }
    },
    {
      "id": "node_6",
      "typeId": "Smoothing",
      "x": 720,
      "y": 400,
      "params": {
        "smoothing": 0.94
      }
    },
    {
      "id": "node_7",
      "typeId": "ShaderVisual",
      "x": 920,
      "y": 280,
      "params": {
        "fragmentShader": "uniform float u_time;\nuniform vec2 u_resolution;\nuniform float u_param1;\nuniform float u_param2;\nuniform float u_param3;\nuniform float u_param4;\nuniform sampler2D u_spectrum;\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / u_resolution;\n    vec2 p = uv * 2.0 - 1.0;\n    p.x *= u_resolution.x / u_resolution.y;\n\n    float angle = atan(p.y, p.x);\n    float radius = length(p);\n\n    float speed = 1.0 + u_param1 * 3.0;\n    float tunnelZ = 1.0 / (radius + 0.1) + u_time * speed;\n    float tunnelA = angle / 3.14159;\n\n    float pattern = sin(tunnelZ * 8.0) * cos(tunnelA * 6.0);\n    pattern += sin(tunnelZ * 4.0 + u_time) * 0.5;\n\n    float bass = u_param2;\n    vec3 col1 = vec3(0.1, 0.2 + bass, 0.8);\n    vec3 col2 = vec3(0.8, 0.1, 0.5 + bass * 0.5);\n\n    vec3 col = mix(col1, col2, pattern * 0.5 + 0.5);\n    col *= 1.0 / (radius * 2.0 + 0.5);\n    col *= 0.5 + u_param1 * 0.5;\n\n    float spec = texture2D(u_spectrum, vec2(abs(tunnelA), 0.0)).r;\n    col += vec3(spec * 0.2, spec * 0.1, spec * 0.3) * (1.0 / (radius + 0.3));\n\n    gl_FragColor = vec4(col, 1.0);\n}\n"
      }
    },
    {
      "id": "node_8",
      "typeId": "OutputCanvas",
      "x": 1140,
      "y": 280,
      "params": {
        "bgR": 0.0,
        "bgG": 0.0,
        "bgB": 0.0
      }
    }
  ],
  "connections": [
    { "sourceNode": "node_1", "sourcePort": 0, "destNode": "node_2", "destPort": 0 },
    { "sourceNode": "node_1", "sourcePort": 0, "destNode": "node_4", "destPort": 0 },
    { "sourceNode": "node_2", "sourcePort": 0, "destNode": "node_3", "destPort": 0 },
    { "sourceNode": "node_4", "sourcePort": 0, "destNode": "node_5", "destPort": 0 },
    { "sourceNode": "node_5", "sourcePort": 0, "destNode": "node_6", "destPort": 0 },
    { "sourceNode": "node_3", "sourcePort": 0, "destNode": "node_7", "destPort": 0 },
    { "sourceNode": "node_6", "sourcePort": 0, "destNode": "node_7", "destPort": 1 },
    { "sourceNode": "node_7", "sourcePort": 0, "destNode": "node_8", "destPort": 0 }
  ]
}
